let pref={originalSettings:null,settings:{values:{"power-saver-state":"15","preference-user-language":"en","preference-theme":"default","preference-scrobbling-position":"50","preference-notification-popup-format":"%artist% - %title%","preference-status-bar-format":"%artist% - %title%","preference-window-title-format":"%artist% - %title%","preference-playlist-format":"%artist% - %title%"},checkboxes:{"preference-enable-notifications":!1,"preference-enable-counter":!0,"preference-enable-animations":!0,"preference-enable-powersaver":!0,"preference-enable-scrobbling":!0,"preference-hide-playlist-tabs":!1,"preference-playback-follows-cursor":!1,"preference-cursor-follows-playback":!1},[`showWhatsNew-${version}`]:!0,keys:[{key:"17+81",action:"addToQueue"},{key:"81",action:"addToQueue"},{key:"74",action:"showSearch"},{key:"66",action:"next"},{key:"86",action:"stop"},{key:"67",action:"playPause"},{key:"88",action:"play"},{key:"90",action:"prev"},{key:"17+38",action:"volumeUp"},{key:"17+40",action:"volumeDown"},{key:"77",action:"toggleMute"},{key:"46",action:"removeFromPlaylist"}],volume:1,activePlaylistId:null,muted:!1,playbackOrder:0,dropbox:{accessToken:null},googledrive:{accessToken:null},lastfm:{accessToken:null}},save(){localStorage.setItem("preferences",JSON.stringify(this.settings))},load(){this.originalSettings=JSON.parse(JSON.stringify(this.settings));let e=localStorage.getItem("preferences");e&&(this.settings=Object.assign({},this.originalSettings,JSON.parse(e))),this.clean([`showWhatsNew-${version}`])},clean(e=[]){["devChannel","showWelcome"].forEach(t=>{e.includes(t)||delete this.settings[t]});let t=Object.keys(this.settings);["showWhatsNew"].forEach(s=>{t.forEach(t=>{!e.includes(t)&&t.match(new RegExp(s))&&delete this.settings[t]})})},import(e){this.settings=e,this.save()},export(){return this.settings},process(){let e=this.settings.values;Object.keys(e).forEach(e=>{let t=document.getElementById(e);t?t.value=this.settings.values[e]:n.warn("missing-element",e)});let t=this.settings.checkboxes;Object.keys(t).forEach(e=>{let t=document.getElementById(e);t?t.checked=this.settings.checkboxes[e]:n.warn("missing-element",e)}),n.renderKeyboardShortcuts(),n.audio.volume=this.settings.volume,n.audio.muted=this.settings.muted,n.updateVolumeState();let s=document.getElementById("playback-order");s?(s.selectedIndex=this.settings.playbackOrder||0,n.audio.loop=!(2-s.selectedIndex)):n.warn("missing-element","playback-order"),document.getElementById("show-on-startup-checkbox").checked=this.settings[`showWhatsNew-${version}`],n.dropbox.accessToken=this.settings.dropbox.accessToken,n.googledrive.accessToken=this.settings.googledrive.accessToken,n.lastfm.accessToken=this.settings.lastfm.accessToken,n.lastfm.userName=this.settings.lastfm.userName,this.counter||(document.getElementById("footer-counter").hidden=!0)},set playbackOrder(e){let t=this.settings.playbackOrder!==e;this.settings.playbackOrder=e,t&&this.save()},set key(e){this.settings.keys.push(e),this.save()},get keys(){return this.settings.keys},set deleteKey(e){this.settings.keys.splice(e,1),this.save()},set input(e){let t;"checkbox"===e.type?(t=this.settings.checkboxes[e.id]!==e.checked,this.settings.checkboxes[e.id]=e.checked):(t=this.settings.values[e.id]!==e.value,this.settings.values[e.id]=e.value),t&&this.save()},set showWhatsNew(e){let t=this.settings[`showWhatsNew-${version}`]!==e;this.settings[`showWhatsNew-${version}`]=e,t&&this.save()},get showWhatsNew(){return this.settings[`showWhatsNew-${version}`]},set lang(e){let t=this.settings.values["preference-user-language"]||"en";this.settings.values["preference-user-language"]=e,t!==e&&this.save()},get lang(){return this.settings.values["preference-user-language"]||"en"},set theme(e){let t=this.settings.values["preference-theme"]!==e;this.settings.values["preference-theme"]=e,t&&this.save()},set powerSaverState(e){let t=this.settings.values["power-saver-state"]!==e;this.settings.values["power-saver-state"]=e,t&&this.save()},set accessToken(e){let t=this.settings[e.cloud].accessToken!==e.accessToken&&e.accessToken.constructor!==Promise;this.settings[e.cloud].accessToken=e.accessToken,t&&this.save()},set activePlaylistId(e){this.settings.activePlaylistId=e,e?this.scrollTop=document.getElementById(e).scrollTop:delete this.settings.scrollTop,this.save()},get activePlaylistId(){return this.settings.activePlaylistId},set scrollTop(e){let t=this.settings.scrollTop!==e;this.settings.scrollTop=e,t&&this.save()},get scrollTop(){return this.settings.scrollTop},set tokenCloud(e){let t=this.settings.tokenCloud!==e;this.settings.tokenCloud=e,t&&this.save()},get tokenCloud(){return this.settings.tokenCloud},set userName(e){let t=this.settings[e.cloud].userName!==e.userName;this.settings[e.cloud].userName=e.userName,t&&this.save()},set muted(e){let t=this.settings.muted!==e;this.settings.muted=e,n.audio.muted=e,n.updateVolumeState(),t&&this.save()},set volume(e){e=parseFloat(e.toFixed(1));let t=this.settings.volume!==e;this.settings.volume=e,n.audio.muted=this.settings.muted=!1,n.audio.volume=e,n.updateVolumeState(),t&&this.save()},get scrobbling(){return this.settings.checkboxes["preference-enable-scrobbling"]},get counter(){return this.settings.checkboxes["preference-enable-counter"]},get notify(){return this.settings.checkboxes["preference-enable-notifications"]},get powerSaverEnabled(){return this.settings.checkboxes["preference-enable-powersaver"]},get cursorFollowsPlaybackEnabled(){return this.settings.checkboxes["preference-cursor-follows-playback"]},get playbackFollowsCursorEnabled(){return this.settings.checkboxes["preference-playback-follows-cursor"]}};pref.load();